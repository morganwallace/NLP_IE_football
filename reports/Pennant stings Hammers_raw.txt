West Ham seemed destined for a third successive clean sheet in the competition as a dour match headed for a goalless draw, only for referee Jonathan Moss to penalise Mohamed Diame for shoving Glenn Whelan in the 82nd minute.
	
Pennant, who had recently arrived on the pitch, curled the free-kick over the top of the wall and beyond the reach of keeper Jussi Jaaskelainen to secure Stoke's second Premier League victory of the season.
The better football was played throughout by Mark Hughes' side with Kenwyne Jones, starting ahead of Peter Crouch, Marc Wilson and Jonathan Walters failing to convert first-half chances.
Wilson and Walters were only denied by a magnificent double save from Jaaskelainen when a goal seemed certain.
West Ham finally discovered some urgency in the last 20 minutes but they were still incapable of troubling keeper Asmir Begovic and two Premier League matches have passed without them scoring.
The return of Andy Carroll, out with a heel injury, cannot come soon enough and the England striker is expected to be available for Southampton on September 15.
This performance may convince Sam Allardyce that reinforcements are needed before the transfer window closes on Monday, while in contrast Hughes must be pleased with the early progress he is making at Stoke.
The visitors' superiority was evident from the start as they moved the ball forward purposefully.
Jones ran almost half the pitch as his strength took him past Kevin Nolan and when James Collins arrived to provide pressure, he skied his shot into the stands from 15 yards out.
Stoke began to ride their luck a bit as Diame and Joey O'Brien caused problems either side of the area but they went desperately close to taking the lead in the 23rd minute.
A dipping long-range shot from Wilson deceived Jaaskelainen, who could only parry it to the side. Walters arrived to bury the follow-up but the Finn reacted just in time.
Stoke were dominating the game but needed to make more of their chances as Steven N'Zonzi thumped a shot into the advertising boards.
It was West Ham who proved wasteful with 10 minutes of the first half remaining after Modibo Maiga directed a perfect cross from Matt Jarvis wide.
The match desperately needed a goal but as the second half progressed it seemed farther away than ever.
Winston Reid landed heavily on his left shoulder following an aerial duel with Jones but, despite being in obvious pain, he continued playing after a brief spell on the sidelines.
West Ham replaced the ineffective Stewart Downing with Ravel Morrison with almost half an hour left, but a burst of pace from Jarvis proved he was still his side's most dangerous player.
Finally Stoke's defence was having to work as crosses began to arrive into their box with increasing regularity, Reid going close on one occasion.
Guy Demel squared the ball across the face of goal but there were no team-mates in place to take advantage.
Then Stoke struck the telling blow with both substitutes involved -- Whelan winning the free-kick that was beautifully buried by Pennant.
